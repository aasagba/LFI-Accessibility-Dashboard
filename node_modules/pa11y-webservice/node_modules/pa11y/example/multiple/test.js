'use strict';

var async = require('async');
var pa11y = require('../..');

// Create a test instance with some default options
var test = pa11y({

	// Log what's happening to the console
	log: {
		debug: console.log.bind(console),
		error: console.error.bind(console),
		info: console.log.bind(console)
	},

	timeout: 10000

});


// Use the async library to run multiple tests in series
// https://github.com/caolan/async
async.parallelLimit([
	function(next) {
		test.run('http://www.bbc.co.uk/news/world/', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('https://www.gov.uk/', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('https://github.com/', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.nature.com/', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.nature.com/', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('https://github.com/nature', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.nature.com/search?article_type=research&order=relevance&q=bacon&hide_ads=true&hide_ensighten=true', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.nature.com/subjects/stars?hide_ads=true&hide_ensighten=true', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.nature.com/nm/journal/v20/n10/full/nm.3665.html', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.nature.com/nchembio/index.html', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.nature.com/nm/journal/v14/n5/full/nm1750.html', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://test-www.nature.com/eye/index.html', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.nature.com/articles/nplants2015125', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.nature.com/articles/nplants2015125?hide_ads=true&hide_ensighten=true', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.nature.com/nplants/', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.nature.com/nplants/?hide_ads=true&hide_ensighten=true', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.nature.com/articles/srep02522', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.nature.com/articles/srep02522?hide_ads=true&hide_ensighten=true', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.skills4studycampus.com/palgrave/', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.palgrave-journals.com/articles/palcomms201514', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://www.palgrave-journals.com/articles/palcomms201514?hide_ads=true&hide_ensighten=true', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://link.springer.com/article/10.1007/s12598-014-0346-8/fulltext.html', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://test-www.nature.com/articles/nplants201580', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://test-www.nature.com/nplants', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('https://twitter.com/', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	},
	function(next) {
		test.run('http://pa11y.org', function(error) {
			if (error) {
				console.error(error.stack);
			}
			next();
		});
	}
], 3, function(error, results) {
	if (error) {
		return console.error(error.message);
	}
	console.log(results.home);
	console.log(results.plants);
});
